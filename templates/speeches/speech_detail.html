{% extends "speeches/base.html" %}

{% block css.custom %}
{{ block.super }}
<style type="text/css">
#speech p:hover {
	background: #E5ECF9;
}
</style>
{% endblock %}

{% block js %}
{{ block.super }}
<script src="http://code.jquery.com/jquery-1.4.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function(){
	$('#speech > p').each(function(i){
		$(this).append('<a href="#p' + i + '" class="graf">Notes</a>');
	});
})
</script>
{% endblock %}

{% block title %}{{ speech.title }} | {{ block.super }}{% endblock %}

{% block content %}
<h2>{{ speech.title }}</h2>
<div id="description">{{ speech.description }}</div>

<div id="speech" class="span-12">
{% block speech %}
{{ speech.transcript_html|safe }}
{% endblock %}
</div>
{% block footnotes %}
{% load markup %}
<script type="text/javascript">
{% regroup footnotes by index as index_list %}

var footnotes = {}
{% for index in index_list %}
footnotes[{{ index.grouper }}]['count'] = {{ index.list|length }};
footnotes[{{ index.grouper }}]['notes'] = [
	{% for footnote in index.list %}{
		type: '{{ footnote.note_type }}',
		icon: '{{ footnote.note_type.icon }}',
		author: '{{ footnote.author.get_full_name }}',
		text: '{{ footnote.text|markdown }}'
	},{% endfor %}
]
{% endfor %}

</script>

{% endblock %}
{% endblock %}