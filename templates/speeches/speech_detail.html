{% extends "speeches/base.html" %}

{% block css %}
{{ block.super }}
<link rel="stylesheet" href="{{ MEDIA_URL }}js/fancybox/fancybox.css" type="text/css" media="screen">
{% endblock %}
{% block js %}
{{ block.super }}
<script src="{{ MEDIA_URL }}js/fancybox/fancybox.js" type="text/javascript"></script>  
 
<script type="text/javascript"> 
 
$(document).ready(function(){
	$('#speech > p').each(function(i){
		// get attached notes
		var notes = $('div#i' + i).children();
		
		if(notes.length >=1) {
		// make a link to grab those notes
		var a = $('<a/>');
		a.attr('class', 'note-link');
		a.attr('href', '#i' + i);
		a.text(notes.length + ' Notes');
		$(this).append(a);
		}
	});
	
	/* Set lightbox config */
	
	$("a.note-link").fancybox({
		'zoomSpeedIn':		300, 
		'zoomSpeedOut':	300, 
		'overlayShow':		true,					  
		'hideOnContentClick': false,
		'autoDimensions'    : false,
		'frameWidth'        : 600,
		'frameHeight'       : 'auto',
		'padding'			: 30,
		'overlayOpacity' 	: .4,
		'overlayColor'		: 000
	});
	
})
</script> 
 <style>
     #footnotes { display: none;  }
 </style>
{% endblock %}

{% block title %}{{ speech.title }} | {{ block.super }}{% endblock %}

{% block speech %}
{{ speech.transcript_html|safe }}
{% endblock %}

{% block bios %}
{{ block.super }}
{% endblock %}

{% block footnotes %}
{% regroup footnotes by index as index_list %}
<div id="footnotes" class="clear">
{% for index in index_list %}
	<div id="i{{ index.grouper }}" class="footnote">
		{% for footnote in index.list %}
		{{ footnote.render|safe }}
		{% endfor %}
	</div>
{% endfor %}
</div>

{% endblock %}

